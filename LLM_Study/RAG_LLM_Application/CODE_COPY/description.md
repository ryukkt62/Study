### Retrieval Augmented Generation (RAG)

* LLM 어플리케이션 개발에서 중요한 개념
    a. LLM 등장 전 NLP에서부터 사용됨
    b. 우리말로하면 검색-증강 생성
    c. 단어를 하나씩 뜯어보자!


1. Retrieval
    a. 데이터를 가져오는 것
    b. 구체적으로는 “컴퓨터 시스템에 저장된 자료를 취득하는 것” 이라는 뜻도 있음
    c. 언어모델이 가지고있지 않은 정보를 가져오는 것
        * 보안이 걸려있는 사내자료
        * GPT4는 23년 12월까지 정보를 가지고 있음

2. Augmented
    a. AR/VR에 사용되는 것과 같은 단어
    b. 마치 사실인 것 처럼(포켓몬고 생각하면 쉬움)
    c. Retrieval된 데이터를 LLM에게 주면서, “마치 이 정보를 아는 것 처럼”

3. Generation
    a. 생성
    b. 내가 가져온 데이터를 제공할테니, 이 정보를 아는 것 처럼, “답변을 생성해라"
        Augmented된 Context(문맥)를 기반으로 LLM에게 답변을 생성하게 하는 것


1. 이제 우리의 고민은?
    a. 답변을 생성하는 것은 LLM의 역할
    b. 우리는 데이터를 잘 가져와서
    c. LLM에게 잘 전달해야함

2. 데이터를 잘 가져오려면?
    a. 일단 잘 저장해야함
    b. 잘 저장하는 것이 매우매우 어려움 - 강의에서 제일 중요한 부분이라고 생각함

3. 잘 전달하려면?
    a. 프롬프트를 잘 활용해야함
    b. 문맥을 어떻게 제공할 것인가도 매우 중요
    c. 잘 가져오더라도 제대로 전달하지 못하면 LLM이 올바른 답변을 주지 못함
        i. LangChain 활용의 장점

사용자가 원하는 정보

1. 사용자의 질문과 관련있는 데이터
    a. 관련이 있다는 것을 어떻게 판단할까?
    b. 관련성 파악을 위해 vector를 활용함
        i. 단어 또는 문장의 유사도를 파악해서 관련성을 측정함

2. Vector를 생성하는 방법
    a. Embedding 모델을 활용해서 vector를 생성함
    b. 문장에서 비슷한 단어가 자주 붙어있는 것을 학습
        i. 왕은 왕자의 아버지다
        ii. 여왕은 왕자의 어머니다
    c. “왕자의” 라는 단어 앞에 등장하는 “왕”과 “여왕”은 유사할 가능성이 높다
    d. Embedding Projector

### Vector Database

1. Embedding 모델을 활용해 생성된 vector를 저장
    a. 단순히 vector만 저장하면 안되고 metadata도 같이 저장(예: 문서의 이름, 페이지 번호, 환각증상을 방지하기 위해 출처를 같이 표기)
        i. 이 항목이 상당히 중요한데, 뒤에 실습하면서 배울예정
        ii. 문서의 이름, 페이지 번호 등등을 같이 저장 -> LLM이 생성하는 답변의 퀄리티가 상승함

2. Vector를 대상으로 유사도 검색 실시
    a. chunking한 문서를 기반으로 사용자의 질문과 가장 비슷한 문서를 가져오는 것 - Retrieval
        i. 소득세법을 RAG의 knowledge base로 활용할 예정
        ii. 문서 전체를 활용하면 속도도 느리고, 토큰수 추과로 답변 생성이 안될수도 있음
        iii. 문서를 chunking, 나눠서 저장해야함
    b. 가져온 문서를 prompt를 통해 LLM에 제공 - Augmented
    c. LLM은 prompt를 활용해서 답변 생성 - Generation
